{% extends 'debts/base.html' %}

{% block title %}Информация об арендаторе{% endblock %}

{% block content %}
<h2>{{ tenant.name }}</h2>
<p><b>Email:</b> {{ tenant.email|default:"—" }}</p>
<p><b>Телефон:</b> {{ tenant.phone|default:"—" }}</p>
<p><b>Договор:</b> {{ tenant.contract.number }} от {{ tenant.contract.date|date:"d.m.Y" }}</p>
<p><b>Ежемесячная оплата:</b> {{ tenant.monthly_rent }} руб.</p>
<p><b>День оплаты:</b> {{ tenant.payment_day }}</p>

<hr>
<h3>Платежи</h3>
<table class="table">
    <tr>
        <th>Дата</th>
        <th>Сумма</th>
        <th>Период</th>
        <th>Статус</th>
    </tr>
    {% for p in payments %}
    <tr>
        <td>{{ p.payment_date|date:"d.m.Y" }}</td>
        <td>{{ p.amount }}</td>
        <td>{{ p.period_start|date:"d.m.Y" }} - {{ p.period_end|date:"d.m.Y" }}</td>
        <td>
            {% if p.is_paid %}
                <span class="paid">Оплачено</span>
            {% else %}
                <span class="debt">Долг</span>
            {% endif %}
        </td>
    </tr>
    {% empty %}
    <tr><td colspan="4">Платежей нет.</td></tr>
    {% endfor %}
</table>

<hr>
<h3>Письма и уведомления</h3>
<ul class="notifications">
    {% for n in notifications %}
    <li>
        <b>{{ n.sent_date|date:"d.m.Y H:i" }}</b> — {{ n.get_notification_type_display }}
        (<a href="{{ n.pdf_file.url }}" target="_blank">открыть PDF</a>)
    </li>
    {% empty %}
    <li>Уведомлений пока нет.</li>
    {% endfor %}
</ul>

<a href="{% url 'tenants_list' %}" class="btn-back">← Назад к списку</a>
{% endblock %}
